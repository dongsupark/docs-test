<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>Tips and tricks - Flatcar Container Linux Documentation</title>
        <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../css/font-awesome-4.5.0.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="../../css/highlight.css">
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        <script src="../../js/jquery-1.10.2.min.js"></script>
        <script src="../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../js/highlight.pack.js"></script> 
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="../..">Flatcar Container Linux Documentation</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                <!--Only display pages not under the hidden tag in mkdocs.yml-->
                        <li >
                            <a href="../..">Home</a>
                        </li>
                <!--Only display pages not under the hidden tag in mkdocs.yml-->
                        <li >
                            <a href="../quickstart/">Quick start</a>
                        </li>
                <!--Only display pages not under the hidden tag in mkdocs.yml-->
                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">Navigation <b class="caret"></b></a>
                            <ul class="dropdown-menu">
                                
  <li class="dropdown-submenu">
    <a href="#">Provisioning</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../provisioning/">Using Container Linux Config</a>
</li>
            
<li >
    <a href="../../container-linux-config-transpiler/doc/overview/">Using Config Transpiler</a>
</li>
            
<li >
    <a href="../../container-linux-config-transpiler/doc/dynamic-data/">CL Config Dynamic Data</a>
</li>
            
<li >
    <a href="../../container-linux-config-transpiler/doc/examples/">CL Config Examples</a>
</li>
            
<li >
    <a href="../../container-linux-config-transpiler/doc/configuration/">CL Config Spec</a>
</li>
    </ul>
  </li>
                                
  <li class="dropdown-submenu">
    <a href="#">Cloud Providers</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../booting-on-ec2/">Amazon EC2</a>
</li>
            
<li >
    <a href="../booting-on-azure/">Azure</a>
</li>
            
<li >
    <a href="../booting-on-digitalocean/">Digital Ocean</a>
</li>
            
<li >
    <a href="../booting-on-google-compute-engine/">Google Compute Engine</a>
</li>
            
<li >
    <a href="../booting-with-qemu/">QEMU</a>
</li>
    </ul>
  </li>
                                
  <li class="dropdown-submenu">
    <a href="#">Bare Metal</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../booting-with-ipxe/">Booting with iPXE</a>
</li>
            
<li >
    <a href="../booting-with-pxe/">Booting with PXE</a>
</li>
            
<li >
    <a href="../installing-to-disk/">Installing to Disk</a>
</li>
            
<li >
    <a href="../booting-with-iso/">Booting from ISO</a>
</li>
            
<li >
    <a href="../root-filesystem-placement/">Root filesystem placement</a>
</li>
    </ul>
  </li>
                                
  <li class="dropdown-submenu">
    <a href="#">Migrating from CoreOS Container Linux</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../migrate-from-container-linux/">Migrating from CoreOS Container Linux</a>
</li>
            
<li >
    <a href="../update-from-container-linux/">Updating from CoreOS Container Linux</a>
</li>
    </ul>
  </li>
                                
  <li class="dropdown-submenu">
    <a href="#">Working with Clusters</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#">Creating Clusters</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../cluster-architectures/">Cluster architectures</a>
</li>
            
<li >
    <a href="../update-strategies/">Update strategies</a>
</li>
            
<li >
    <a href="../cluster-discovery/">Clustering machines</a>
</li>
            
<li >
    <a href="../verify-images/">Verify Flatcar Container Linux Images with GPG</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">Customizing Clusters</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../network-config-with-networkd/">Using networkd to customize networking</a>
</li>
            
<li >
    <a href="../using-systemd-drop-in-units/">Using systemd drop-in units</a>
</li>
            
<li >
    <a href="../using-environment-variables-in-systemd-units/">Using environment variables in systemd units</a>
</li>
            
<li >
    <a href="../configuring-dns/">Configuring DNS</a>
</li>
            
<li >
    <a href="../configuring-date-and-timezone/">Configuring date & timezone</a>
</li>
            
<li >
    <a href="../adding-users/">Adding users</a>
</li>
            
<li >
    <a href="../other-settings/">Kernel modules / sysctl parameters</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">Scaling Clusters</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../adding-disk-space/">Adding disk space</a>
</li>
            
<li >
    <a href="../mounting-storage/">Mounting storage</a>
</li>
            
<li >
    <a href="../power-management/">Power management</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">Managing Clusters</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../registry-authentication/">Registry authentication</a>
</li>
            
<li >
    <a href="../iscsi/">iSCSI configuration</a>
</li>
            
<li >
    <a href="../adding-swap/">Adding swap</a>
</li>
            
<li >
    <a href="../booting-on-ecs/">Amazon EC2 Container Service</a>
</li>
            
<li >
    <a href="../getting-started-with-systemd/">Using systemd to manage Docker containers</a>
</li>
            
<li >
    <a href="../using-systemd-and-udev-rules/">Using systemd and udev rules</a>
</li>
            
<li >
    <a href="../switching-channels/">Switching release channels</a>
</li>
            
<li >
    <a href="../scheduling-tasks-with-systemd-timers/">Scheduling tasks with systemd</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">Securing Clusters</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../customizing-sshd/">Customizing the SSH daemon</a>
</li>
            
<li >
    <a href="../sssd/">Configuring SSSD on Flatcar Container Linux</a>
</li>
            
<li >
    <a href="../hardening-guide/">Hardening a Flatcar Container Linux machine</a>
</li>
            
<li >
    <a href="../trusted-computing-hardware-requirements/">Trusted Computing Hardware Requirements</a>
</li>
            
<li >
    <a href="../adding-certificate-authorities/">Adding Cert Authorities</a>
</li>
            
<li >
    <a href="../selinux/">Using SELinux</a>
</li>
            
<li >
    <a href="../disabling-smt/">Disabling SMT</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">Debugging Clusters</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../install-debugging-tools/">Install debugging tools</a>
</li>
            
<li >
    <a href="../btrfs-troubleshooting/">Working with btrfs</a>
</li>
            
<li >
    <a href="../reading-the-system-log/">Reading the system log</a>
</li>
            
<li >
    <a href="../collecting-crash-logs/">Collecting crash logs</a>
</li>
            
<li >
    <a href="../manual-rollbacks/">Manual Flatcar Container Linux rollbacks</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                
  <li class="dropdown-submenu">
    <a href="#">Container Runtimes</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#">Docker</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../getting-started-with-docker/">Getting started with Docker</a>
</li>
            
<li >
    <a href="../customizing-docker/">Customizing Docker</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                            </ul>
                        </li>
                <!--Only display pages not under the hidden tag in mkdocs.yml-->
                </ul>

            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i> Search
                    </a>
                </li>
                    <li >
                        <a rel="next" href="../sdk-modifying-coreos/">
                            <i class="fa fa-arrow-left"></i> Previous
                        </a>
                    </li>
                    <li >
                        <a rel="prev" href="../selinux/">
                            Next <i class="fa fa-arrow-right"></i>
                        </a>
                    </li>
            </ul>
        </div>
    </div>
</div>

        <div class="container">
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="main active"><a href="#tips-and-tricks">Tips and tricks</a></li>
            <li><a href="#finding-all-open-pull-requests-and-issues">Finding all open pull requests and issues</a></li>
            <li><a href="#searching-all-repo-code">Searching all repo code</a></li>
            <li><a href="#add-new-upstream-package">Add new upstream package</a></li>
            <li><a href="#creating-sdk-with-different-options">Creating SDK with different options</a></li>
            <li><a href="#caching-git-https-passwords">Caching git https passwords</a></li>
            <li><a href="#ssh-config">SSH config</a></li>
            <li><a href="#hide-loop-devices-from-desktop-environments">Hide loop devices from desktop environments</a></li>
            <li><a href="#leaving-developer-mode">Leaving developer mode</a></li>
            <li><a href="#build-everything-from-scratch">Build everything from scratch</a></li>
            <li><a href="#modify-or-update-invididual-packages">Modify or update invididual packages</a></li>
            <li><a href="#use-binary-packages-from-a-shared-build-store">Use binary packages from a shared build store</a></li>
            <li><a href="#known-issues">Known issues</a></li>
            <li><a href="#constants-and-ids">Constants and IDs</a></li>
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<h1 id="tips-and-tricks">Tips and tricks<a class="headerlink" href="#tips-and-tricks" title="Permanent link">&para;</a></h1>
<h2 id="finding-all-open-pull-requests-and-issues">Finding all open pull requests and issues<a class="headerlink" href="#finding-all-open-pull-requests-and-issues" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="https://github.com/issues?user=flatcar-linux">Flatcar Container Linux Issues</a></li>
<li><a href="https://github.com/pulls?user=flatcar-linux">Flatcar Container Linux Pull Requests</a></li>
</ul>
<h2 id="searching-all-repo-code">Searching all repo code<a class="headerlink" href="#searching-all-repo-code" title="Permanent link">&para;</a></h2>
<p>Using <code class="codehilite">repo grep</code> you can search across all of the Git repos at once:</p>
<pre class="codehilite"><code class="language-sh">repo grep CONFIG_EXTRA_FIRMWARE</code></pre>

<p>Note: this could take some time.</p>
<h3 id="base-system-dependency-graph">Base system dependency graph<a class="headerlink" href="#base-system-dependency-graph" title="Permanent link">&para;</a></h3>
<p>Get a view into what the base system will contain and why it will contain those things with the emerge tree view:</p>
<pre class="codehilite"><code class="language-sh">emerge-amd64-usr --emptytree -p -v --tree coreos-base/coreos-dev</code></pre>

<p>Get a tree view of the SDK dependencies:</p>
<pre class="codehilite"><code class="language-sh">emerge-amd64-usr --emptytree -p -v --tree coreos-base/hard-host-depends</code></pre>

<h2 id="add-new-upstream-package">Add new upstream package<a class="headerlink" href="#add-new-upstream-package" title="Permanent link">&para;</a></h2>
<p>An overview on contributing new packages to Flatcar Container Linux:</p>
<ul>
<li>create a git branch for the work</li>
<li>fetch the the target package(s) from upstream (Gentoo)</li>
<li>make any necessary changes for Flatcar Container Linux</li>
<li>add the package(s) as a dependency of <code class="codehilite">coreos-base/coreos</code></li>
<li>build the package(s) and test</li>
<li>commit changes to git</li>
<li>push the branch to your GitHub account and create a pull request</li>
</ul>
<p>See <a href="https://github.com/flatcar-linux/etcd/blob/master/CONTRIBUTING.md">CONTRIBUTING</a> for guidelines before you push.</p>
<p>The following Flatcar Container Linux repositories are used:</p>
<ul>
<li>Packages that will work unmodified are versioned in <code class="codehilite">src/third_party/portage-stable</code></li>
<li>Packages with Container-Linux-specific changes are versioned in <code class="codehilite">src/third_party/coreos-overlay</code></li>
</ul>
<p>Use <code class="codehilite">repo start</code> to create a work branch before making any changes.</p>
<pre class="codehilite"><code class="language-sh">~/trunk/src/scripts $ repo start my_package_update --all </code></pre>

<p>You can use <code class="codehilite">scripts/update_ebuilds</code> to fetch unmodified packages into <code class="codehilite">src/third_party/portage-stable</code> and add the files to git. The package argument should be in the format of <code class="codehilite">category/package-name</code>, e.g.:</p>
<pre class="codehilite"><code class="language-sh">~/trunk/src/scripts $ ./update_ebuilds sys-block/open-iscsi</code></pre>

<p>Modified packages must be moved out of <code class="codehilite">src/third_party/portage-stable</code> to <code class="codehilite">src/third_party/coreos-overlay</code>.</p>
<p>If you know in advance that any files in the upstream package will need to be changed, the package can be fetched from upstream Gentoo directly into <code class="codehilite">src/third_party/coreos-overlay</code>. e.g.:</p>
<pre class="codehilite"><code class="language-sh">~/trunk/src/third_party/coreos-overlay $ mkdir -p sys-block/open-iscsi
~/trunk/src/third_party/coreos-overlay $ rsync -av rsync://rsync.gentoo.org/gentoo-portage/sys-block/open-iscsi/ sys-block/open-iscsi/</code></pre>

<p>The tailing / prevents rsync from creating the directory for the package so you don't end up with <code class="codehilite">sys-block/open-iscsi/open-iscsi</code>. Remember to add any new files to git.</p>
<p>To quickly test your new package(s), use the following commands:</p>
<pre class="codehilite"><code class="language-sh">~/trunk/src/scripts $ # Manually merge a package in the chroot
~/trunk/src/scripts $ emerge-amd64-usr packagename
~/trunk/src/scripts $ # Manually unmerge a package in the chroot
~/trunk/src/scripts $ emerge-amd64-usr --unmerge packagename
~/trunk/src/scripts $ # Remove a binary from the cache
~/trunk/src/scripts $ sudo rm /build/amd64-usr/packages/category/packagename-version.tbz2</code></pre>

<p>To recreate the chroot prior to a clean rebuild, exit the chroot and run:</p>
<pre class="codehilite"><code class="language-sh">~/flatcar-sdk $ cork create --replace</code></pre>

<p>To include the new package as a dependency of Flatcar Container Linux, add the package to the end of the <code class="codehilite">RDEPEND</code> environment variable in <code class="codehilite">coreos-base/coreos/coreos-0.0.1.ebuild</code> then increment the revision of Flatcar Container Linux by renaming the softlink (e.g.):</p>
<pre class="codehilite"><code class="language-sh">~/trunk/src/third_party/coreos-overly $ git mv coreos-base/coreos/coreos-0.0.1-r237.ebuild coreos-base/coreos/coreos-0.0.1-r238.ebuild</code></pre>

<p>The new package will now be built and installed as part of the normal build flow when you run <code class="codehilite">build_packages</code> again.</p>
<p>If tests are successful, commit the changes, push to your GitHub fork and create a pull request.</p>
<h3 id="packaging-references">Packaging references<a class="headerlink" href="#packaging-references" title="Permanent link">&para;</a></h3>
<p>References:</p>
<ul>
<li>Chromium OS <a href="http://www.chromium.org/chromium-os/how-tos-and-troubleshooting/portage-build-faq">Portage Build FAQ</a></li>
<li><a href="http://devmanual.gentoo.org/">Gentoo Development Guide</a></li>
<li><a href="https://wiki.gentoo.org/wiki/Package_Manager_Specification">Package Manager Specification</a></li>
</ul>
<h2 id="creating-sdk-with-different-options">Creating SDK with different options<a class="headerlink" href="#creating-sdk-with-different-options" title="Permanent link">&para;</a></h2>
<p>To create SDK from a non-default manifest branch, for example, <code class="codehilite">new-sdk</code>:</p>
<pre class="codehilite"><code>~/flatcar-sdk $ cork create --manifest-branch=new-sdk</code></pre>

<p>To create SDK with a non-default SDK version, for example, <code class="codehilite">2229.0.0</code>:</p>
<pre class="codehilite"><code>~/flatcar-sdk $ cork create --sdk-version=2229.0.0</code></pre>

<h2 id="caching-git-https-passwords">Caching git https passwords<a class="headerlink" href="#caching-git-https-passwords" title="Permanent link">&para;</a></h2>
<p>Turn on the credential helper and git will save your password in memory for some time:</p>
<pre class="codehilite"><code class="language-sh">git config --global credential.helper cache</code></pre>

<p>Note: You need git 1.7.10 or newer to use the credential helper</p>
<p>Why doesn't Flatcar Container Linux use SSH in the git remotes?  Because we can't do anonymous clones from GitHub with an SSH URL.  This will be fixed eventually.</p>
<h2 id="ssh-config">SSH config<a class="headerlink" href="#ssh-config" title="Permanent link">&para;</a></h2>
<p>You will be booting lots of VMs with on the fly ssh key generation. Add this in your <code class="codehilite">$HOME/.ssh/config</code> to stop the annoying fingerprint warnings.</p>
<pre class="codehilite"><code class="language-ini">Host 127.0.0.1
  StrictHostKeyChecking no
  UserKnownHostsFile /dev/null
  User core
  LogLevel QUIET</code></pre>

<h2 id="hide-loop-devices-from-desktop-environments">Hide loop devices from desktop environments<a class="headerlink" href="#hide-loop-devices-from-desktop-environments" title="Permanent link">&para;</a></h2>
<p>By default desktop environments will diligently display any mounted devices including loop devices used to construct Flatcar Container Linux disk images. If the daemon responsible for this happens to be <code class="codehilite">udisks</code> then you can disable this behavior with the following udev rule:</p>
<pre class="codehilite"><code class="language-sh">echo 'SUBSYSTEM==&quot;block&quot;, KERNEL==&quot;ram*|loop*&quot;, ENV{UDISKS_PRESENTATION_HIDE}=&quot;1&quot;, ENV{UDISKS_PRESENTATION_NOPOLICY}=&quot;1&quot;' &gt; /etc/udev/rules.d/85-hide-loop.rules
udevadm control --reload</code></pre>

<h2 id="leaving-developer-mode">Leaving developer mode<a class="headerlink" href="#leaving-developer-mode" title="Permanent link">&para;</a></h2>
<p>Some daemons act differently in "dev mode". For example update_engine refuses to auto-update or connect to HTTPS URLs. If you need to test something out of dev_mode on a vm you can do the following:</p>
<pre class="codehilite"><code>mv /root/.dev_mode{,.old}</code></pre>

<p>If you want to permanently leave you can run the following:</p>
<pre class="codehilite"><code>crossystem disable_dev_request=1; reboot</code></pre>

<h2 id="build-everything-from-scratch">Build everything from scratch<a class="headerlink" href="#build-everything-from-scratch" title="Permanent link">&para;</a></h2>
<p>If you want to build everything from scratch, but at the same time want to exclude several packages that take much time.</p>
<pre class="codehilite"><code class="language-sh">emerge-amd64-usr --emptytree -1 -v --tree --exclude=&quot;dev-lang/rust sys-devel/gcc&quot; coreos-base/coreos-dev</code></pre>

<p>Or if you want to do the rebuild by running <code class="codehilite">build_packages</code>, you should remove the binary package of <code class="codehilite">coreos</code> before rebuilding it:</p>
<pre class="codehilite"><code class="language-sh">emerge-amd64-usr --unmerge coreos-base/coreos
rm -f /build/amd64-usr/var/lib/portage/pkgs/coreos-base/coreos-0.0.1*.tbz2
./build_packages</code></pre>

<h2 id="modify-or-update-invididual-packages">Modify or update invididual packages<a class="headerlink" href="#modify-or-update-invididual-packages" title="Permanent link">&para;</a></h2>
<p>Before or after setting up the SDK with <code class="codehilite">./setup_board</code> you can modify the package definitions in <code class="codehilite">third_party/coreos-overlay/</code>.
Changes for toolchain packages like the compiler need to be done before running <code class="codehilite">./setup_board</code> but any changes for the final image
can be done before running <code class="codehilite">./build_packages &amp;&amp; ./build_image</code>.
All build commands can be run multiple times but whether your last changes are picked up depends on whether the package revision
was increased (by renaming the ebuild file) or the package uninstalled and the binary package removed (See the last commands in
<em>Build everything from scratch</em> where it was done for the parent package <code class="codehilite">coreos-base/coreos</code>).
Therefore, we recommend to run every build command only once in a fresh SDK to be sure that your most recent modification is used.</p>
<p>For some packages, like the Linux kernel in <code class="codehilite">coreos-source</code>, <code class="codehilite">coreos-kernel</code>, and <code class="codehilite">coreos-modules</code>, it is enough to rename
the ebuild file and it will download a new kernel version.
Ebuilds for other packages under <code class="codehilite">coreos-overlay/</code> reference a specific commit in <code class="codehilite">CROS_WORKON_COMMIT</code> which needs to be changed.
If files of a package changed their hash sums, use <code class="codehilite">ebuild packagename.ebuild manifest</code> to recalculate the hashes for
the <code class="codehilite">Manifest</code> file.</p>
<p>Here is an example of updating an individual package to a newer version:</p>
<pre class="codehilite"><code class="language-sh">git mv aaa-bbb/package/package-0.0.1-r1.ebuild aaa-bbb/package/package-0.0.1-r2.ebuild
ebuild aaa-bbb/package/package-0.0.1-r2.ebuild manifest
emerge-amd64-usr -1 -v aaa-bbb/package</code></pre>

<p>Do not forget about updating its version and revision in <code class="codehilite">package.accept_keywords</code> files in the <code class="codehilite">profiles</code> directory.
In some cases such a file can pin an exact version of a specific package, which needs to be updated as well.</p>
<h2 id="use-binary-packages-from-a-shared-build-store">Use binary packages from a shared build store<a class="headerlink" href="#use-binary-packages-from-a-shared-build-store" title="Permanent link">&para;</a></h2>
<p>Some packages like <code class="codehilite">coreos-modules</code> take a long time to build. Use </p>
<pre class="codehilite"><code>./build_packages --getbinpkgver=$(gsutil cat gs://…/boards/amd64-usr/current-master/version.txt |&amp; sed -n 's/^FLATCAR_VERSION=//p')</code></pre>

<p>to use packages from the another build store.</p>
<h2 id="known-issues">Known issues<a class="headerlink" href="#known-issues" title="Permanent link">&para;</a></h2>
<h3 id="build95packages-fails-on-coreos-base">build_packages fails on coreos-base<a class="headerlink" href="#build95packages-fails-on-coreos-base" title="Permanent link">&para;</a></h3>
<p>Sometimes coreos-dev or coreos builds will fail in <code class="codehilite">build_packages</code> with a backtrace pointing to <code class="codehilite">epoll</code>. This hasn't been tracked down but running <code class="codehilite">build_packages</code> again should fix it. The error looks something like this:</p>
<pre class="codehilite"><code>Packages failed:
coreos-base/coreos-dev-0.1.0-r63
coreos-base/coreos-0.0.1-r187</code></pre>

<h3 id="newly-added-package-fails-checking-for-kernel-sources">Newly added package fails checking for kernel sources<a class="headerlink" href="#newly-added-package-fails-checking-for-kernel-sources" title="Permanent link">&para;</a></h3>
<p>It may be necessary to comment out kernel source checks from the ebuild if the build fails, as Flatcar Container Linux does not yet provide visibility of the configured kernel source at build time.  Usually this is not a problem, but may lead to warning messages.</p>
<h3 id="coreos-kernel-fails-to-link-after-previously-aborting-a-build"><code class="codehilite">coreos-kernel</code> fails to link after previously aborting a build<a class="headerlink" href="#coreos-kernel-fails-to-link-after-previously-aborting-a-build" title="Permanent link">&para;</a></h3>
<p>Emerging <code class="codehilite">coreos-kernel</code> (either manually or through <code class="codehilite">build_packages</code>) may fail with the error:</p>
<pre class="codehilite"><code>/usr/lib/gcc/x86_64-pc-linux-gnu/4.9.4/../../../../x86_64-pc-linux-gnu/bin/ld: scripts/kconfig/conf.o: relocation R_X86_64_32 against `.rodata.str1.8' can not be used when making a shared object; recompile with -fPIC scripts/kconfig/conf.o: error adding symbols: Bad value</code></pre>

<p>This indicates the ccache is corrupt. To clear the ccache, run:</p>
<pre class="codehilite"><code>CCACHE_DIR=/var/tmp/ccache ccache -C</code></pre>

<p>To avoid corrupting the ccache, do not abort builds.</p>
<h3 id="build_image-hangs-while-emerging-packages-after-previously-aborting-a-build"><code class="codehilite">build_image</code> hangs while emerging packages after previously aborting a build<a class="headerlink" href="#build_image-hangs-while-emerging-packages-after-previously-aborting-a-build" title="Permanent link">&para;</a></h3>
<p>Delete all <code class="codehilite">*.portage_lockfile</code>s in <code class="codehilite">/build/&lt;arch&gt;/</code>. To avoid stale lockfiles, do not abort builds.</p>
<h2 id="constants-and-ids">Constants and IDs<a class="headerlink" href="#constants-and-ids" title="Permanent link">&para;</a></h2>
<h3 id="flatcar-container-linux-app-id">Flatcar Container Linux app ID<a class="headerlink" href="#flatcar-container-linux-app-id" title="Permanent link">&para;</a></h3>
<p>This UUID is used to identify Flatcar Container Linux to the update service and elsewhere.</p>
<pre class="codehilite"><code>e96281a6-d1af-4bde-9a0a-97b76e56dc57</code></pre>

<h3 id="gpt-uuid-types">GPT UUID types<a class="headerlink" href="#gpt-uuid-types" title="Permanent link">&para;</a></h3>
<ul>
<li>Flatcar Container Linux Root: 5dfbf5f4-2848-4bac-aa5e-0d9a20b745a6</li>
<li>Flatcar Container Linux Reserved: c95dc21a-df0e-4340-8d7b-26cbfa9a03e0</li>
<li>Flatcar Container Linux Raid Containing Root: be9067b9-ea49-4f15-b4f6-f36f8c9e1818</li>
</ul></div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>var base_url = '../..';</script>
        <script src="../../js/base.js"></script>
        <script src="../../search/require.js"></script>
        <script src="../../search/search.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="Keyboard Shortcuts Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Keyboard Shortcuts</h4>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td><kbd>&larr;</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td><kbd>&rarr;</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>


    </body>
</html>
