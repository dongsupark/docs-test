<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>Running Flatcar Container Linux on Vagrant - Flatcar Container Linux Documentation</title>
        <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../css/font-awesome-4.5.0.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="../../css/highlight.css">
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        <script src="../../js/jquery-1.10.2.min.js"></script>
        <script src="../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../js/highlight.pack.js"></script> 
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="../..">Flatcar Container Linux Documentation</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                <!--Only display pages not under the hidden tag in mkdocs.yml-->
                        <li >
                            <a href="../..">Home</a>
                        </li>
                <!--Only display pages not under the hidden tag in mkdocs.yml-->
                        <li >
                            <a href="../quickstart/">Quick start</a>
                        </li>
                <!--Only display pages not under the hidden tag in mkdocs.yml-->
                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">Navigation <b class="caret"></b></a>
                            <ul class="dropdown-menu">
                                
  <li class="dropdown-submenu">
    <a href="#">Provisioning</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../provisioning/">Using Container Linux Config</a>
</li>
            
<li >
    <a href="../../container-linux-config-transpiler/doc/overview/">Using Config Transpiler</a>
</li>
            
<li >
    <a href="../../container-linux-config-transpiler/doc/dynamic-data/">CL Config Dynamic Data</a>
</li>
            
<li >
    <a href="../../container-linux-config-transpiler/doc/examples/">CL Config Examples</a>
</li>
            
<li >
    <a href="../../container-linux-config-transpiler/doc/configuration/">CL Config Spec</a>
</li>
    </ul>
  </li>
                                
  <li class="dropdown-submenu">
    <a href="#">Cloud Providers</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../booting-on-ec2/">Amazon EC2</a>
</li>
            
<li >
    <a href="../booting-on-azure/">Azure</a>
</li>
            
<li >
    <a href="../booting-on-digitalocean/">Digital Ocean</a>
</li>
            
<li >
    <a href="../booting-on-google-compute-engine/">Google Compute Engine</a>
</li>
            
<li >
    <a href="../booting-with-qemu/">QEMU</a>
</li>
    </ul>
  </li>
                                
  <li class="dropdown-submenu">
    <a href="#">Bare Metal</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../booting-with-ipxe/">Booting with iPXE</a>
</li>
            
<li >
    <a href="../booting-with-pxe/">Booting with PXE</a>
</li>
            
<li >
    <a href="../installing-to-disk/">Installing to Disk</a>
</li>
            
<li >
    <a href="../booting-with-iso/">Booting from ISO</a>
</li>
            
<li >
    <a href="../root-filesystem-placement/">Root filesystem placement</a>
</li>
    </ul>
  </li>
                                
  <li class="dropdown-submenu">
    <a href="#">Migrating from CoreOS Container Linux</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../migrate-from-container-linux/">Migrating from CoreOS Container Linux</a>
</li>
            
<li >
    <a href="../update-from-container-linux/">Updating from CoreOS Container Linux</a>
</li>
    </ul>
  </li>
                                
  <li class="dropdown-submenu">
    <a href="#">Working with Clusters</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#">Creating Clusters</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../cluster-architectures/">Cluster architectures</a>
</li>
            
<li >
    <a href="../update-strategies/">Update strategies</a>
</li>
            
<li >
    <a href="../cluster-discovery/">Clustering machines</a>
</li>
            
<li >
    <a href="../verify-images/">Verify Flatcar Container Linux Images with GPG</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">Customizing Clusters</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../network-config-with-networkd/">Using networkd to customize networking</a>
</li>
            
<li >
    <a href="../using-systemd-drop-in-units/">Using systemd drop-in units</a>
</li>
            
<li >
    <a href="../using-environment-variables-in-systemd-units/">Using environment variables in systemd units</a>
</li>
            
<li >
    <a href="../configuring-dns/">Configuring DNS</a>
</li>
            
<li >
    <a href="../configuring-date-and-timezone/">Configuring date & timezone</a>
</li>
            
<li >
    <a href="../adding-users/">Adding users</a>
</li>
            
<li >
    <a href="../other-settings/">Kernel modules / sysctl parameters</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">Scaling Clusters</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../adding-disk-space/">Adding disk space</a>
</li>
            
<li >
    <a href="../mounting-storage/">Mounting storage</a>
</li>
            
<li >
    <a href="../power-management/">Power management</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">Managing Clusters</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../registry-authentication/">Registry authentication</a>
</li>
            
<li >
    <a href="../iscsi/">iSCSI configuration</a>
</li>
            
<li >
    <a href="../adding-swap/">Adding swap</a>
</li>
            
<li >
    <a href="../booting-on-ecs/">Amazon EC2 Container Service</a>
</li>
            
<li >
    <a href="../getting-started-with-systemd/">Using systemd to manage Docker containers</a>
</li>
            
<li >
    <a href="../using-systemd-and-udev-rules/">Using systemd and udev rules</a>
</li>
            
<li >
    <a href="../switching-channels/">Switching release channels</a>
</li>
            
<li >
    <a href="../scheduling-tasks-with-systemd-timers/">Scheduling tasks with systemd</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">Securing Clusters</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../customizing-sshd/">Customizing the SSH daemon</a>
</li>
            
<li >
    <a href="../sssd/">Configuring SSSD on Flatcar Container Linux</a>
</li>
            
<li >
    <a href="../hardening-guide/">Hardening a Flatcar Container Linux machine</a>
</li>
            
<li >
    <a href="../trusted-computing-hardware-requirements/">Trusted Computing Hardware Requirements</a>
</li>
            
<li >
    <a href="../adding-certificate-authorities/">Adding Cert Authorities</a>
</li>
            
<li >
    <a href="../selinux/">Using SELinux</a>
</li>
            
<li >
    <a href="../disabling-smt/">Disabling SMT</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">Debugging Clusters</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../install-debugging-tools/">Install debugging tools</a>
</li>
            
<li >
    <a href="../btrfs-troubleshooting/">Working with btrfs</a>
</li>
            
<li >
    <a href="../reading-the-system-log/">Reading the system log</a>
</li>
            
<li >
    <a href="../collecting-crash-logs/">Collecting crash logs</a>
</li>
            
<li >
    <a href="../manual-rollbacks/">Manual Flatcar Container Linux rollbacks</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                
  <li class="dropdown-submenu">
    <a href="#">Container Runtimes</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#">Docker</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../getting-started-with-docker/">Getting started with Docker</a>
</li>
            
<li >
    <a href="../customizing-docker/">Customizing Docker</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                            </ul>
                        </li>
                <!--Only display pages not under the hidden tag in mkdocs.yml-->
                </ul>

            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i> Search
                    </a>
                </li>
                    <li >
                        <a rel="next" href="../booting-on-google-compute-engine/">
                            <i class="fa fa-arrow-left"></i> Previous
                        </a>
                    </li>
                    <li >
                        <a rel="prev" href="../booting-on-virtualbox/">
                            Next <i class="fa fa-arrow-right"></i>
                        </a>
                    </li>
            </ul>
        </div>
    </div>
</div>

        <div class="container">
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="main active"><a href="#running-flatcar-container-linux-on-vagrant">Running Flatcar Container Linux on Vagrant</a></li>
            <li><a href="#install-vagrant-and-virtualbox">Install Vagrant and VirtualBox</a></li>
            <li><a href="#install-flatcar-container-linux">Install Flatcar Container Linux</a></li>
            <li><a href="#starting-a-cluster">Starting a cluster</a></li>
            <li><a href="#single-machine">Single machine</a></li>
            <li><a href="#shared-folder-setup">Shared folder setup</a></li>
            <li><a href="#new-box-versions">New box versions</a></li>
            <li><a href="#using-flatcar-container-linux">Using Flatcar Container Linux</a></li>
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<h1 id="running-flatcar-container-linux-on-vagrant">Running Flatcar Container Linux on Vagrant<a class="headerlink" href="#running-flatcar-container-linux-on-vagrant" title="Permanent link">&para;</a></h1>
<p>Running Flatcar Container Linux with Vagrant is one way to bring up a single machine or virtualize an entire cluster on your laptop. Since the true power of Flatcar Container Linux can be seen with a cluster, we're going to concentrate on that. Instructions for a single machine can be found <a href="#single-machine">towards the end</a> of the guide.</p>
<p>You can direct questions to the <a href="irc://irc.freenode.org:6667/#flatcar">IRC channel</a> or <a href="https://groups.google.com/forum/#!forum/flatcar-linux-dev">mailing list</a>.</p>
<h2 id="install-vagrant-and-virtualbox">Install Vagrant and VirtualBox<a class="headerlink" href="#install-vagrant-and-virtualbox" title="Permanent link">&para;</a></h2>
<p>Vagrant is a simple-to-use command line virtual machine manager. There are install packages available for Windows, Linux and OS X. Find the latest installer on the <a href="http://www.vagrantup.com/downloads.html">Vagrant downloads page</a>. Be sure to get version 2.0.4 or greater, to be able to detect Flatcar images correctly.</p>
<p>Vagrant can use either the free VirtualBox provider or the commercial VMware provider. Instructions for both are below. For the VirtualBox provider, version 4.3.10 or greater is required.</p>
<h2 id="install-flatcar-container-linux">Install Flatcar Container Linux<a class="headerlink" href="#install-flatcar-container-linux" title="Permanent link">&para;</a></h2>
<p>You can import the flatcar box and boot it with Vagrant.
You'll find it in <code class="codehilite">https://${CHANNEL}.release.flatcar-linux.net/amd64-usr/${VERSION}/flatcar_production_vagrant.box</code>.
Make sure you download the signature (it's available in <code class="codehilite">https://${CHANNEL}.release.flatcar-linux.net/amd64-usr/${VERSION}/flatcar_production_vagrant.box.sig</code>) and check it before proceeding.</p>
<p>For example, to get the latest alpha:</p>
<pre class="codehilite"><code>$ wget https://alpha.release.flatcar-linux.net/amd64-usr/current/flatcar_production_vagrant.box
$ wget https://alpha.release.flatcar-linux.net/amd64-usr/current/flatcar_production_vagrant.box.sig
$ gpg --verify flatcar_production_vagrant.box.sig
gpg: assuming signed data in 'flatcar_production_vagrant.box'
gpg: Signature made Thu 15 Mar 2018 10:29:23 AM CET
gpg:                using RSA key A621F1DA96C93C639506832D603443A1D0FC498C
gpg: Good signature from &quot;Flatcar Buildbot (Official Builds) &lt;buildbot@flatcar-linux.org&gt;&quot; [ultimate]
$ vagrant box add flatcar flatcar_production_vagrant.box
==&gt; box: Box file was not detected as metadata. Adding it directly...
==&gt; box: Adding box 'flatcar' (v0) for provider:
    box: Unpacking necessary files from: file:///tmp/flatcar_production_vagrant.box
==&gt; box: Successfully added box 'flatcar' (v0) for 'virtualbox'!
$ vagrant init flatcar
A `Vagrantfile` has been placed in this directory. You are now
ready to `vagrant up` your first virtual environment! Please read
the comments in the Vagrantfile as well as documentation on
`vagrantup.com` for more information on using Vagrant.
$ vagrant up
Bringing machine 'default' up with 'virtualbox' provider...
==&gt; default: Importing base box 'flatcar'...
==&gt; default: Matching MAC address for NAT networking...
==&gt; default: Setting the name of the VM: vagrant_default_1520510346048_14823
==&gt; default: Clearing any previously set network interfaces...
==&gt; default: Preparing network interfaces based on configuration...
    default: Adapter 1: nat
==&gt; default: Forwarding ports...
    default: 22 (guest) =&gt; 2222 (host) (adapter 1)
==&gt; default: Running 'pre-boot' VM customizations...
==&gt; default: Booting VM...
==&gt; default: Waiting for machine to boot. This may take a few minutes...
    default: SSH address: 127.0.0.1:2222
    default: SSH username: core
    default: SSH auth method: private key
==&gt; default: Machine booted and ready!
$ vagrant ssh
Last login: Thu Mar 15 17:02:25 UTC 2018 from 10.0.2.2 on ssh
Flatcar Container Linux by Kinvolk alpha (1702.1.0)
core@localhost ~ $</code></pre>

<h2 id="starting-a-cluster">Starting a cluster<a class="headerlink" href="#starting-a-cluster" title="Permanent link">&para;</a></h2>
<p>You can configure your Vagrant machine by having a <code class="codehilite">Vagrantfile</code> example file:</p>
<pre class="codehilite"><code>ENV[&quot;TERM&quot;] = &quot;xterm-256color&quot;
ENV[&quot;LC_ALL&quot;] = &quot;en_US.UTF-8&quot;

Vagrant.require_version '&gt;= 2.0.4'

Vagrant.configure('2') do |config|
  config.ssh.username = 'core'
  config.ssh.insert_key = true
  config.vm.synced_folder '.', '/vagrant', disabled: true
  config.vm.provider :virtualbox do |v|
    v.check_guest_additions = false
    v.functional_vboxsf = false
    v.cpus = 2
    v.memory = 2048
  end
end</code></pre>

<h3 id="start-machines-using-vagrants-default-virtualbox-provider">Start machines using Vagrant's default VirtualBox provider<a class="headerlink" href="#start-machines-using-vagrants-default-virtualbox-provider" title="Permanent link">&para;</a></h3>
<p>Start the machine(s):</p>
<pre class="codehilite"><code class="language-sh">vagrant up</code></pre>

<p>List the status of the running machines:</p>
<pre class="codehilite"><code class="language-sh">$ vagrant status
Current machine states:

core-01                   running (virtualbox)
core-02                   running (virtualbox)
core-03                   running (virtualbox)

This environment represents multiple VMs. The VMs are all listed
above with their current state. For more information about a specific
VM, run `vagrant status NAME`.</code></pre>

<p>Connect to one of the machines:</p>
<pre class="codehilite"><code class="language-sh">vagrant ssh core-01 -- -A</code></pre>

<h3 id="start-machines-using-vagrants-vmware-provider">Start machines using Vagrant's VMware provider<a class="headerlink" href="#start-machines-using-vagrants-vmware-provider" title="Permanent link">&para;</a></h3>
<p>If you have purchased the <a href="http://www.vagrantup.com/vmware">VMware Vagrant provider</a>, run the following commands:</p>
<pre class="codehilite"><code class="language-sh">vagrant up --provider vmware_fusion
vagrant ssh core-01 -- -A</code></pre>

<h2 id="single-machine">Single machine<a class="headerlink" href="#single-machine" title="Permanent link">&para;</a></h2>
<p>To start a single machine, we need to provide some config parameters in cloud-config format via the <code class="codehilite">user-data</code> file.</p>
<p>Start the machine:</p>
<pre class="codehilite"><code class="language-sh">vagrant up</code></pre>

<p>Connect to the machine:</p>
<pre class="codehilite"><code class="language-sh">vagrant ssh core-01 -- -A</code></pre>

<h3 id="start-machine-using-vagrants-vmware-provider">Start machine using Vagrant's VMware provider<a class="headerlink" href="#start-machine-using-vagrants-vmware-provider" title="Permanent link">&para;</a></h3>
<p>If you have purchased the <a href="http://www.vagrantup.com/vmware">VMware Vagrant provider</a>, run the following commands:</p>
<pre class="codehilite"><code class="language-sh">vagrant up --provider vmware_fusion
vagrant ssh core-01 -- -A</code></pre>

<h2 id="shared-folder-setup">Shared folder setup<a class="headerlink" href="#shared-folder-setup" title="Permanent link">&para;</a></h2>
<p>Optionally, you can share a folder from your laptop into the virtual machine. This is useful for easily getting code and Dockerfiles into Flatcar Container Linux.</p>
<pre class="codehilite"><code class="language-ini">config.vm.synced_folder &quot;.&quot;, &quot;/home/core/share&quot;, id: &quot;core&quot;, :nfs =&gt; true,  :mount_options   =&gt; ['nolock,vers=3,udp']</code></pre>

<p>After a 'vagrant reload' you will be prompted for your local machine password.</p>
<h2 id="new-box-versions">New box versions<a class="headerlink" href="#new-box-versions" title="Permanent link">&para;</a></h2>
<p>Flatcar Container Linux is a rolling release distribution and versions that are out of date will automatically update. If you want to start from the most up to date version you will need to make sure that you have the latest box file of Flatcar Container Linux. You can do this using <code class="codehilite">vagrant box update</code> - or, simply remove the old box file and Vagrant will download the latest one the next time you <code class="codehilite">vagrant up</code>.</p>
<pre class="codehilite"><code class="language-sh">vagrant box remove flatcar-alpha vmware_fusion
vagrant box remove flatcar-alpha virtualbox</code></pre>

<p>If you'd like to download the box separately, you can download the URL contained in the Vagrantfile and add it manually:</p>
<pre class="codehilite"><code class="language-sh">vagrant box add flatcar-alpha &lt;path-to-box-file&gt;</code></pre>

<h2 id="using-flatcar-container-linux">Using Flatcar Container Linux<a class="headerlink" href="#using-flatcar-container-linux" title="Permanent link">&para;</a></h2>
<p>Now that you have a machine booted it is time to play around. Check out the <a href="../quickstart/">Flatcar Container Linux Quickstart</a> guide, learn about <a href="https://coreos.com/blog/coreos-clustering-with-vagrant/">Flatcar Container Linux clustering with Vagrant</a>, or dig into <a href="https://docs.flatcar-linux.org">more specific topics</a>.</p></div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>var base_url = '../..';</script>
        <script src="../../js/base.js"></script>
        <script src="../../search/require.js"></script>
        <script src="../../search/search.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="Keyboard Shortcuts Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Keyboard Shortcuts</h4>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td><kbd>&larr;</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td><kbd>&rarr;</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>


    </body>
</html>
