<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>Getting started with Docker - Flatcar Container Linux Documentation</title>
        <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../css/font-awesome-4.5.0.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="../../css/highlight.css">
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        <script src="../../js/jquery-1.10.2.min.js"></script>
        <script src="../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../js/highlight.pack.js"></script> 
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="../..">Flatcar Container Linux Documentation</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                <!--Only display pages not under the hidden tag in mkdocs.yml-->
                        <li >
                            <a href="../..">Home</a>
                        </li>
                <!--Only display pages not under the hidden tag in mkdocs.yml-->
                        <li >
                            <a href="../quickstart/">Quick start</a>
                        </li>
                <!--Only display pages not under the hidden tag in mkdocs.yml-->
                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">Navigation <b class="caret"></b></a>
                            <ul class="dropdown-menu">
                                
  <li class="dropdown-submenu">
    <a href="#">Provisioning</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../provisioning/">Using Container Linux Config</a>
</li>
            
<li >
    <a href="../../container-linux-config-transpiler/doc/overview/">Using Config Transpiler</a>
</li>
            
<li >
    <a href="../../container-linux-config-transpiler/doc/dynamic-data/">CL Config Dynamic Data</a>
</li>
            
<li >
    <a href="../../container-linux-config-transpiler/doc/examples/">CL Config Examples</a>
</li>
            
<li >
    <a href="../../container-linux-config-transpiler/doc/configuration/">CL Config Spec</a>
</li>
    </ul>
  </li>
                                
  <li class="dropdown-submenu">
    <a href="#">Cloud Providers</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../booting-on-ec2/">Amazon EC2</a>
</li>
            
<li >
    <a href="../booting-on-azure/">Azure</a>
</li>
            
<li >
    <a href="../booting-on-digitalocean/">Digital Ocean</a>
</li>
            
<li >
    <a href="../booting-on-google-compute-engine/">Google Compute Engine</a>
</li>
            
<li >
    <a href="../booting-with-qemu/">QEMU</a>
</li>
    </ul>
  </li>
                                
  <li class="dropdown-submenu">
    <a href="#">Bare Metal</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../booting-with-ipxe/">Booting with iPXE</a>
</li>
            
<li >
    <a href="../booting-with-pxe/">Booting with PXE</a>
</li>
            
<li >
    <a href="../installing-to-disk/">Installing to Disk</a>
</li>
            
<li >
    <a href="../booting-with-iso/">Booting from ISO</a>
</li>
            
<li >
    <a href="../root-filesystem-placement/">Root filesystem placement</a>
</li>
    </ul>
  </li>
                                
  <li class="dropdown-submenu">
    <a href="#">Migrating from CoreOS Container Linux</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../migrate-from-container-linux/">Migrating from CoreOS Container Linux</a>
</li>
            
<li >
    <a href="../update-from-container-linux/">Updating from CoreOS Container Linux</a>
</li>
    </ul>
  </li>
                                
  <li class="dropdown-submenu">
    <a href="#">Working with Clusters</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#">Creating Clusters</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../cluster-architectures/">Cluster architectures</a>
</li>
            
<li >
    <a href="../update-strategies/">Update strategies</a>
</li>
            
<li >
    <a href="../cluster-discovery/">Clustering machines</a>
</li>
            
<li >
    <a href="../verify-images/">Verify Flatcar Container Linux Images with GPG</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">Customizing Clusters</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../network-config-with-networkd/">Using networkd to customize networking</a>
</li>
            
<li >
    <a href="../using-systemd-drop-in-units/">Using systemd drop-in units</a>
</li>
            
<li >
    <a href="../using-environment-variables-in-systemd-units/">Using environment variables in systemd units</a>
</li>
            
<li >
    <a href="../configuring-dns/">Configuring DNS</a>
</li>
            
<li >
    <a href="../configuring-date-and-timezone/">Configuring date & timezone</a>
</li>
            
<li >
    <a href="../adding-users/">Adding users</a>
</li>
            
<li >
    <a href="../other-settings/">Kernel modules / sysctl parameters</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">Scaling Clusters</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../adding-disk-space/">Adding disk space</a>
</li>
            
<li >
    <a href="../mounting-storage/">Mounting storage</a>
</li>
            
<li >
    <a href="../power-management/">Power management</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">Managing Clusters</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../registry-authentication/">Registry authentication</a>
</li>
            
<li >
    <a href="../iscsi/">iSCSI configuration</a>
</li>
            
<li >
    <a href="../adding-swap/">Adding swap</a>
</li>
            
<li >
    <a href="../booting-on-ecs/">Amazon EC2 Container Service</a>
</li>
            
<li >
    <a href="../getting-started-with-systemd/">Using systemd to manage Docker containers</a>
</li>
            
<li >
    <a href="../using-systemd-and-udev-rules/">Using systemd and udev rules</a>
</li>
            
<li >
    <a href="../switching-channels/">Switching release channels</a>
</li>
            
<li >
    <a href="../scheduling-tasks-with-systemd-timers/">Scheduling tasks with systemd</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">Securing Clusters</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../customizing-sshd/">Customizing the SSH daemon</a>
</li>
            
<li >
    <a href="../sssd/">Configuring SSSD on Flatcar Container Linux</a>
</li>
            
<li >
    <a href="../hardening-guide/">Hardening a Flatcar Container Linux machine</a>
</li>
            
<li >
    <a href="../trusted-computing-hardware-requirements/">Trusted Computing Hardware Requirements</a>
</li>
            
<li >
    <a href="../adding-certificate-authorities/">Adding Cert Authorities</a>
</li>
            
<li >
    <a href="../selinux/">Using SELinux</a>
</li>
            
<li >
    <a href="../disabling-smt/">Disabling SMT</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">Debugging Clusters</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../install-debugging-tools/">Install debugging tools</a>
</li>
            
<li >
    <a href="../btrfs-troubleshooting/">Working with btrfs</a>
</li>
            
<li >
    <a href="../reading-the-system-log/">Reading the system log</a>
</li>
            
<li >
    <a href="../collecting-crash-logs/">Collecting crash logs</a>
</li>
            
<li >
    <a href="../manual-rollbacks/">Manual Flatcar Container Linux rollbacks</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                
  <li class="dropdown-submenu">
    <a href="#">Container Runtimes</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#">Docker</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="./">Getting started with Docker</a>
</li>
            
<li >
    <a href="../customizing-docker/">Customizing Docker</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                            </ul>
                        </li>
                <!--Only display pages not under the hidden tag in mkdocs.yml-->
                </ul>

            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i> Search
                    </a>
                </li>
                    <li >
                        <a rel="next" href="../generate-self-signed-certificates/">
                            <i class="fa fa-arrow-left"></i> Previous
                        </a>
                    </li>
                    <li >
                        <a rel="prev" href="../getting-started-with-systemd/">
                            Next <i class="fa fa-arrow-right"></i>
                        </a>
                    </li>
            </ul>
        </div>
    </div>
</div>

        <div class="container">
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="main active"><a href="#getting-started-with-docker">Getting started with Docker</a></li>
            <li><a href="#docker-cli-basics">Docker CLI basics</a></li>
            <li><a href="#launching-a-container">Launching a container</a></li>
            <li><a href="#committing-a-container">Committing a container</a></li>
            <li><a href="#keeping-the-apache-container-running">Keeping the Apache container running</a></li>
            <li><a href="#using-the-docker-registry">Using the Docker registry</a></li>
            <li><a href="#more-information">More information</a></li>
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<h1 id="getting-started-with-docker">Getting started with Docker<a class="headerlink" href="#getting-started-with-docker" title="Permanent link">&para;</a></h1>
<p>Docker is an open-source project that makes creating and managing Linux containers really easy. Containers are like extremely lightweight VMs – they allow code to run in isolation from other containers but safely share the machine’s resources, all without the overhead of a hypervisor.</p>
<p>Docker containers can boot extremely fast (in milliseconds!) which gives you unprecedented flexibility in managing load across your cluster. For example, instead of running chef on each of your VMs, it’s faster and more reliable to have your build system create a container and launch it on the appropriate number of Flatcar Container Linux hosts. This guide will show you how to launch a container, install some software on it, commit that container, and optionally launch it on another Flatcar Container Linux machine. Before starting, make sure you've got at least one Flatcar Container Linux machine up and running &mdash; try it on <a href="../booting-on-ec2/">Amazon EC2</a> or locally with <a href="../booting-on-vagrant/">Vagrant</a>.</p>
<h2 id="docker-cli-basics">Docker CLI basics<a class="headerlink" href="#docker-cli-basics" title="Permanent link">&para;</a></h2>
<p>Docker has a <a href="https://docs.docker.com/engine/reference/commandline/cli/">straightforward CLI</a> that allows you to do almost everything you could want to a container. All of these commands use the image id (ex. be29975e0098), the image name (ex. myusername/webapp) and the container id (ex. 72d468f455ea) interchangeably depending on the operation you are trying to do. This is confusing at first, so pay special attention to what you're using.</p>
<h2 id="launching-a-container">Launching a container<a class="headerlink" href="#launching-a-container" title="Permanent link">&para;</a></h2>
<p>Launching a container is simple as <code class="codehilite">docker run</code> + the image name you would like to run + the command to run within the container. If the image doesn't exist on your local machine, Docker will attempt to fetch it from the public image registry. Later we'll explore how to use Docker with a private registry. It's important to note that containers are designed to stop once the command executed within them has exited. For example, if you ran <code class="codehilite">/bin/echo hello world</code> as your command, the container will start, print hello world and then stop:</p>
<pre class="codehilite"><code class="language-sh">docker run ubuntu /bin/echo hello world</code></pre>

<p>Let's launch an Ubuntu container and install Apache inside of it using the bash prompt:</p>
<pre class="codehilite"><code class="language-sh">docker run -t -i ubuntu /bin/bash</code></pre>

<p>The <code class="codehilite">-t</code> and <code class="codehilite">-i</code> flags allocate a pseudo-tty and keep stdin open even if not attached. This will allow you to use the container like a traditional VM as long as the bash prompt is running. Install Apache with <code class="codehilite">apt-get update &amp;&amp; apt-get install apache2</code>. You're probably wondering what address you can connect to in order to test that Apache was correctly installed...we'll get to that after we commit the container.</p>
<h2 id="committing-a-container">Committing a container<a class="headerlink" href="#committing-a-container" title="Permanent link">&para;</a></h2>
<p>After that completes, we need to <code class="codehilite">commit</code> these changes to our container with the container ID and the image name.</p>
<p>To find the container ID, open another shell (so the container is still running) and read the ID using <code class="codehilite">docker ps</code>.</p>
<p>The image name is in the format of <code class="codehilite">username/name</code>. We're going to use <code class="codehilite">coreos</code> as our username in this example but you should <a href="https://hub.docker.com/account/signup/">sign up for a Docker.IO user account</a> and use that instead.</p>
<p>It's important to note that you can commit using any username and image name locally, but to push an image to the public registry, the username must be a valid <a href="https://hub.docker.com/account/signup/">Docker.IO user account</a>.</p>
<p>Commit the container with the container ID, your username, and the name <code class="codehilite">apache</code>:</p>
<pre class="codehilite"><code class="language-sh">docker commit 72d468f455ea coreos/apache</code></pre>

<p>The overlay filesystem works similar to git: our image now builds off of the <code class="codehilite">ubuntu</code> base and adds another layer with Apache on top. These layers get cached separately so that you won't have to pull down the ubuntu base more than once.</p>
<h2 id="keeping-the-apache-container-running">Keeping the Apache container running<a class="headerlink" href="#keeping-the-apache-container-running" title="Permanent link">&para;</a></h2>
<p>Now we have our Ubuntu container with Apache running in one shell and an image of that container sitting on disk. Let's launch a new container based on that image but set it up to keep running indefinitely. The basic syntax looks like this, but we need to configure a few additional options that we'll fill in as we go:</p>
<pre class="codehilite"><code class="language-sh">docker run [options] [image] [process]</code></pre>

<p>The first step is to tell Docker that we want to run our <code class="codehilite">coreos/apache</code> image:</p>
<pre class="codehilite"><code class="language-sh">docker run [options] coreos/apache [process]</code></pre>

<h3 id="run-container-detached">Run container detached<a class="headerlink" href="#run-container-detached" title="Permanent link">&para;</a></h3>
<p>When running Docker containers manually, the most important option is to run the container in detached mode with the <code class="codehilite">-d</code> flag. This will output the container ID to show that the command was successful, but nothing else. At any time you can run <code class="codehilite">docker ps</code> in the other shell to view a list of the running containers. Our command now looks like:</p>
<pre class="codehilite"><code class="language-sh">docker run -d coreos/apache [process]</code></pre>

<p>After you are comfortable with the mechanics of running containers by hand, it's recommended to use <a href="../getting-started-with-systemd/">systemd units</a> to run your containers on a cluster of Flatcar Container Linux machines.</p>
<p>Do not run containers with detached mode inside of systemd unit files. Detached mode prevents your init system, in our case systemd, from monitoring the process that owns the container because detached mode forks it into the background. To prevent this issue, just omit the <code class="codehilite">-d</code> flag if you aren't running something manually.</p>
<h3 id="run-apache-in-foreground">Run Apache in foreground<a class="headerlink" href="#run-apache-in-foreground" title="Permanent link">&para;</a></h3>
<p>We need to run the apache process in the foreground, since our container will stop when the process specified in the <code class="codehilite">docker run</code> command stops. We can do this with a flag <code class="codehilite">-D</code> when starting the apache2 process:</p>
<pre class="codehilite"><code class="language-sh">/usr/sbin/apache2ctl -D FOREGROUND</code></pre>

<p>Let's add that to our command:</p>
<pre class="codehilite"><code class="language-sh">docker run -d coreos/apache /usr/sbin/apache2ctl -D FOREGROUND</code></pre>

<h3 id="permanently-running-a-container">Permanently running a container<a class="headerlink" href="#permanently-running-a-container" title="Permanent link">&para;</a></h3>
<p>While the sections above explained how to run a container when configuring it, for a production setup, you should not manually start and babysit containers.</p>
<p>Instead, create a systemd unit file to make systemd keep that container running. See the <a href="../getting-started-with-systemd/">Getting Started with systemd</a> for details.</p>
<h3 id="network-access-to-80">Network access to 80<a class="headerlink" href="#network-access-to-80" title="Permanent link">&para;</a></h3>
<p>The default apache install will be running on port 80. To give our container access to traffic over port 80, we use the <code class="codehilite">-p</code> flag and specify the port on the host that maps to the port inside the container. In our case we want 80 for each, so we include <code class="codehilite">-p 80:80</code> in our command:</p>
<pre class="codehilite"><code class="language-sh">docker run -d -p 80:80 coreos/apache /usr/sbin/apache2ctl -D FOREGROUND</code></pre>

<p>You can now run this command on your Flatcar Container Linux host to create the container. You should see the default apache webpage when you load either <code class="codehilite">localhost:80</code> or the IP of your remote server. Be sure that any firewall or EC2 Security Group allows traffic to port 80.</p>
<h2 id="using-the-docker-registry">Using the Docker registry<a class="headerlink" href="#using-the-docker-registry" title="Permanent link">&para;</a></h2>
<p>Earlier we downloaded the ubuntu image remotely from the Docker public registry because it didn't exist on our local machine. We can also push local images to the public registry (or a private registry) very easily with the <code class="codehilite">push</code> command:</p>
<pre class="codehilite"><code class="language-sh">docker push coreos/apache</code></pre>

<p>To push to a private repository the syntax is very similar. First, we must prefix our image with the host running our private registry instead of our username. List images by running <code class="codehilite">docker images</code> and insert the correct ID into the <code class="codehilite">tag</code> command:</p>
<pre class="codehilite"><code class="language-sh">docker tag f455ea72d468 registry.example.com:5000/apache</code></pre>

<p>After tagging, the image needs to be pushed to the registry:</p>
<pre class="codehilite"><code class="language-sh">docker push registry.example.com:5000/apache</code></pre>

<p>Once the image is done uploading, you should be able to start the exact same container on a different Flatcar Container Linux host by running:</p>
<pre class="codehilite"><code class="language-sh">docker run -d -p 80:80 registry.example.com:5000/apache /usr/sbin/apache2ctl -D FOREGROUND</code></pre>

<h2 id="more-information">More information<a class="headerlink" href="#more-information" title="Permanent link">&para;</a></h2>
<p><a class="btn btn-default" href="https://coreos.com/why/#containers">Docker Overview</a>
<a class="btn btn-default" href="http://www.docker.com/">Docker Website</a>
<a class="btn btn-default" href="https://docs.docker.com/mac/started/">docker's Getting Started Guide</a></p></div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>var base_url = '../..';</script>
        <script src="../../js/base.js"></script>
        <script src="../../search/require.js"></script>
        <script src="../../search/search.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="Keyboard Shortcuts Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Keyboard Shortcuts</h4>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td><kbd>&larr;</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td><kbd>&rarr;</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>


    </body>
</html>
